<html>
<head>
	<meta name="description" content="An app for producing linguistics syntax trees from labelled bracket notation." />
	<title>Syntax Tree Generator</title>
	<link type="text/css" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet" />	
	<link type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />	
	<style type="text/css">
		textarea { resize: vertical; }
		a.example { text-decoration: none; color: #4183C4!important; }
	</style>
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-5">
				<h1>Syntax Tree Generator</h1>
				<div class="form-group">
					<textarea id="i" rows="8" class="form-control">[S [NP This] [VP [V is] [^NP a wug]]]</textarea>
				</div>
				
				<h3>Options</h3><div>
					<table>
						<col width="1*">
						<col width="1*">
						<tr>
							<td colspan="2" align="center"><div id="font-style-radio" class="btn-group btn-group-toggle" data-toggle="buttons">
								<label for="serif" class="btn btn-primary"><input type="radio" name="font-style" id="serif" value="serif" class="redraw" />Serif</label>
								<label for="sans-serif" class="btn btn-primary active"><input type="radio" name="font-style" id="sans-serif" value="sans-serif" class="redraw" checked />Sans-Serif</label>
								<label for="monospace" class="btn btn-primary"><input type="radio" name="font-style" id="monospace" value="monospace" class="redraw" />Monospace</label>
							</div></td>
						</tr>
						<tr>
							<td align="center">Terminals:</td>
							<td align="center">Non-terminals:</td>
						</tr>
						<tr>
							<td align="center"><div id="term-font-check" class="btn-group btn-group-toggle" data-toggle="buttons">
								<label for="term-bold" class="btn btn-primary"><input type="checkbox" id="term-bold" class="redraw" />Bold</label>
								<label for="term-ital" class="btn btn-primary"><input type="checkbox" id="term-ital" class="redraw" />Italic</label>
							</span></td>
							<td align="center"><div id="nonterm-font-check" class="btn-group btn-group-toggle" data-toggle="buttons">
								<label for="nonterm-bold" class="btn btn-primary"><input type="checkbox" id="nonterm-bold" class="redraw" />Bold</label>
								<label for="nonterm-ital" class="btn btn-primary"><input type="checkbox" id="nonterm-ital" class="redraw" />Italic</label>
							</span></td>
						</tr>
						<tr>
							<td align="left">Font size:</td>
							<td><div id="font-size-slider"></div></td>
						</tr>
						<tr>
							<td align="left">Height:</td>
							<td><div id="vert-space-slider"></div></td>
						</tr>
						<tr>
							<td align="left">Width:</td>
							<td><div id="hor-space-slider"></div></td>
						</tr>
						<tr>
							<td align="center" colspan="2"><div class="btn-group btn-group-toggle" data-toggle="buttons">
								<label for="color-check" class="btn btn-primary active"><input type="checkbox" id="color-check" class="redraw" checked />Color</label>
								<label for="term-lines" class="btn btn-primary active"><input type="checkbox" id="term-lines" class="redraw" checked />Terminal lines</label>
								
							</div></td>
						</tr>
						<tr>
							<td align="center" colspan="2"><a href="#" id="make-link" class="btn btn-primary">Generate link</a></td>
						</tr>
					</table>
				</div>
			
				<h3>Help</h3>
				<p>Use labelled bracket notation. This app will build the tree as you type and will attempt to close any brackets that you may be missing. Save the image to your computer by right-clicking on it and selecting "Save image as". For more information, including on how to draw movement lines, visit the <a href="https://github.com/mshang/syntree/wiki">wiki</a>.</p>
				<h3>Examples</h3>
				<a class="example" href="?i=[NP^ Alice]">[NP^ Alice]</a><br />
				<a class="example" href="?i=[NP [N Alice] and [N Bob]]">[NP [N Alice] and [N Bob]]</a><br />
				<a class="example" href="?i=[S[NP[N Alice]][VP[V is][NP[N'[N a student][PP^ of physics">[S[NP[N Alice]][VP[V is][NP[N'[N a student][PP^ of physics</a><br />
				<a class="example" href="?i=[S [X_a Movement] [Y example &lt;a&gt;]]">[S [X_a Movement] [Y example &lt;a&gt;]]</a>
			</div>
			<div class="col-md-7 text-center">
				<div id="image-goes-here" class="card d-inline-block mt-2" style="overflow: hidden"></div>
			</div>
		</div>
		<footer class="row">
			<div class="col-12 text-center">
				(C) 2011 by <a href="http://mshang.ca/">Miles Shang</a>, see <a href="LICENSE.txt">license</a>. |
				<a href="https://github.com/mshang/syntree">Original GitHub Repository</a> |
				<a href="https://github.com/dprebyl/syntree">Fork GitHub Repository</a>
			</div>
		</footer>
	</div>

	<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
	<script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
	<script type="text/javascript" src="js/base64.js"></script>
	<script type="text/javascript" src="js/canvas2image.js"></script>
	<script type="text/javascript" src="js/syntree.js"></script>
	<script type="text/javascript">
		function handler(font_size_update, vert_space_update, hor_space_update) {
		try {
			// Initialize the various options.
			var term_font = "";
			var nonterm_font = "";
			var color = false;
			var term_lines = false;
			if (document.getElementById("term-ital").checked)
				term_font = term_font + "italic ";
			if (document.getElementById("term-bold").checked)
				term_font = term_font + "bold ";
			if (document.getElementById("nonterm-ital").checked)
				nonterm_font = nonterm_font + "italic ";
			if (document.getElementById("nonterm-bold").checked)
				nonterm_font = nonterm_font + "bold ";
			if (document.getElementById("color-check").checked)
				color = true;
			if (document.getElementById("term-lines").checked)
				term_lines = true;
			font_size = $("#font-size-slider").slider( "option", "value" );
			vert_space = $("#vert-space-slider").slider( "option", "value" );
			hor_space = $("#hor-space-slider").slider( "option", "value" );
			if (font_size_update) font_size = font_size_update;
			if (vert_space_update) vert_space = vert_space_update;
			if (hor_space_update) hor_space = hor_space_update;
			term_font = term_font + font_size + "pt ";
			nonterm_font = nonterm_font + font_size + "pt ";
			term_font = term_font + $('input:radio[name=font-style]:checked').val();
			nonterm_font = nonterm_font + $('input:radio[name=font-style]:checked').val();
			
			// Get the string.
			var str = document.getElementById("i").value;
			
			/*$("#image-goes-here").text(str + ", " + font_size + ", " + 
				term_font + ", " + nonterm_font + ", " + vert_space + ", " + hor_space);*/
			
			var img = go(str, font_size, term_font, nonterm_font, vert_space, hor_space, color, term_lines);
			$("#image-goes-here").empty();
			$("#image-goes-here").append(img);
			
		} catch (err) {
			if (debug) {
				throw(err);
			} else { 
				if (err == "canvas")
					$("#image-goes-here").text("Browser not supported.");
			}
		} // try-catch
		return false;
		} // handler()

		$(function() {
			// UI
			$("#font-size-slider").slider({value: 12, min: 8, max: 16, step: 1});
			$("#vert-space-slider").slider({value: 35, min: 35, max: 70, step: 5});
			$("#hor-space-slider").slider({value: 10, min: 10, max: 50, step: 5});
			
			try {
				var qs = decodeURIComponent(window.location.search.slice(1));
				qs = qs.replace(/^i=/,"");
				qs = qs.replace(/\+/g," ");
				if (qs == "") throw "";
				document.getElementById("i").value = qs;
			} catch (err) {}
			
			handler();
			
			// Events
			$("#i").keypress(function() {handler(); return true;});
			$("#i").keyup(function() {handler(); return true;});
			$("#i").keydown(function() {handler(); return true;});
			$("#i").change(function() {handler(); return true;});
			$(".redraw").change(function() {return handler()});
			$("#make-link").click(function() {
				var loc = window.location.href;
				loc = loc.replace(window.location.search, "");
				
				window.prompt ("Link for this tree:", loc + "?i=" +
					encodeURIComponent(document.getElementById("i").value));
				return false;
			});
			$("#font-size-slider").bind("slide", function (event, ui) {
				handler(ui.value, null, null); return true;
			});
			$("#vert-space-slider").bind("slide", function (event, ui) {
				handler(null, ui.value, null); return true;
			});
			$("#hor-space-slider").bind("slide", function (event, ui) {
				handler(null, null, ui.value); return true;
			});
		});
	</script>
</body>
</html>